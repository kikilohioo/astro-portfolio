---
import type { GetStaticPaths } from "astro";
import { getCollection, render } from "astro:content";
import Layout from "../../../layouts/Layout.astro";
import type { Project } from "../../../interfaces/Project";
import { Icon } from "astro-icon/components";

export const getStaticPaths = (async () => {
  const projects = await getCollection("projects");

  return projects.map((project: Project) => {
    const { slug, data } = project;
    const { title } = data;

    return {
      params: { id: slug },
      props: { project },
    };
  });
}) satisfies GetStaticPaths;

const { project } = Astro.props;
const { data, slug } = project;
const { title, author, image, readtime, description, buy } = data;

const { Content } = await render(project);

export const prerender = true;
---

<Layout title={title}>
  <main class="max-w-4xl mx-auto px-6 py-12">
    <!-- Portada + Info principal -->
    <div class="grid grid-cols-1 md:grid-cols-2 gap-8 items-center">
      <div
        transition:name={`image-container-${slug}`}
        class="relative flex flex-col items-center rounded-xl"
      >
        <img
          transition:name={`image-${slug}`}
          src={image}
          alt={title}
          class="w-full h-[400px] object-cover rounded-xl shadow-lg"
        />
        <a href={`/projects/${slug}/demo`} class="absolute flex text-center bottom-0 right-0 h-13 m-4 px-3 items-center justify-center rounded-full shadow-lg hover:shadow-xl transition-shadow bg-gradient-to-r from-pink-500 to-rose-500">
          <Icon name="link" size={30} class="text-gray-800 my-4" />
        </a>
      </div>

      <div>
        <h1
          transition:name={`h3-title-${slug}`}
          class="text-4xl font-bold text-white mb-4"
        >
          {title}
        </h1>
        <p class="text-gray-200 leading-relaxed">{description}</p>
      </div>
    </div>

    <!-- SecciÃ³n extra: detalle -->
    <section class="mt-12">
      <hr class="mb-10" />
      <div class="prose prose-invert">
        <Content class="mt-6" />
      </div>
    </section>
  </main>
</Layout>
<style>
  hr{
    border-color: white !important;
  }
</style>