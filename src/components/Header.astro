---
const currentPath = Astro.url.pathname; // obtiene la ruta actual

export const prerender = true;
---

<header
  class="fixed top-0 left-0 w-full z-50 backdrop-blur-md transition-all duration-300 bg-gradient-to-b from-white/20 to-transparent backdrop-blur-md"
>
  <div
    class="container mx-auto px-20 py-4 flex justify-between items-center h-30"
  >
    <!-- Logo / Nombre -->
    <a
      id="title-link"
      href="/"
      class="font-mono text-3xl font-bold text-teal-300 hover:text-teal-400 transition-colors duration-300"
    ></a>

    <!-- Navegación desktop -->
    <nav>
      <ul class="hidden md:flex space-x-15">
        <li class="flex items-center">
          <div class="w-[120px] text-center">
            <!-- ancho fijo -->
            <a
              href="/"
              class={`menu-text-item block transition-colors
        ${
          currentPath === "/"
            ? "menu-item text-teal-300 font-bold"
            : "text-white hover:text-teal-200 transition-colors duration-300"
        }`}
            >
              Home
            </a>
          </div>
        </li>
        <li class="flex items-center">
          <div class="w-[120px] text-center">
            <!-- ancho fijo -->
            <a
              href="/projects"
              class={`menu-text-item block transition-colors
        ${
          currentPath === "/projects"
            ? "menu-item text-teal-300 font-bold"
            : "text-white hover:text-teal-200 transition-colors duration-300"
        }`}
            >
              Projects
            </a>
          </div>
        </li>
        <li class="flex items-center">
          <div class="w-[120px] text-center">
            <!-- ancho fijo -->
            <a
              href="/experience"
              class={`menu-text-item block transition-colors
        ${
          currentPath === "/experience"
            ? "menu-item text-teal-300 font-bold"
            : "text-white hover:text-teal-200 transition-colors duration-300"
        }`}
            >
              Experience
            </a>
          </div>
        </li>
        <li class="flex items-center">
          <div class="w-[120px] text-center">
            <!-- ancho fijo -->
            <a
              href="/contact"
              class={`menu-text-item block transition-colors
        ${
          currentPath === "/contact"
            ? "menu-item text-teal-300 font-bold"
            : "text-white hover:text-teal-200 transition-colors duration-300"
        }`}
            >
              Contact
            </a>
          </div>
        </li>
      </ul>
    </nav>

    <!-- Botón hamburguesa móvil -->
    <div class="md:hidden">
      <button id="mobile-menu-button" class="text-white focus:outline-none">
        <svg
          class="w-6 h-6"
          fill="none"
          stroke="currentColor"
          stroke-width="2"
          viewBox="0 0 24 24"
        >
          <path
            stroke-linecap="round"
            stroke-linejoin="round"
            d="M4 6h16M4 12h16M4 18h16"></path>
        </svg>
      </button>
    </div>
  </div>

  <!-- Menú móvil -->
  <div
    id="mobile-menu"
    class="hidden md:hidden bg-white/90 backdrop-blur-md shadow-md"
  >
    <ul class="flex flex-col px-6 py-4 space-y-3">
      <li>
        <a
          href="#home"
          class="block text-gray-800 hover:text-teal-500 transition-colors"
          >Home</a
        >
      </li>
      <li>
        <a
          href="#projects"
          class="block text-gray-800 hover:text-teal-500 transition-colors"
          >Projects</a
        >
      </li>
      <li>
        <a
          href="#experience"
          class="block text-gray-800 hover:text-teal-500 transition-colors"
          >Experience</a
        >
      </li>
      <li>
        <a
          href="#contact"
          class="block text-gray-800 hover:text-teal-500 transition-colors"
          >Contact</a
        >
      </li>
    </ul>
  </div>
</header>

<script is:inline>
  const menuButton = document.getElementById("mobile-menu-button");
  const mobileMenu = document.getElementById("mobile-menu");

  menuButton.addEventListener("click", () => {
    mobileMenu.classList.toggle("hidden");
  });

  // Typing effect
  const text = "Hi, I'm Caiqui Viera";
  const element = document.getElementById("title-link");

  let index = 0;
  const speed = 100; // ms por letra

  function type() {
    if (index < text.length) {
      element.textContent += text.charAt(index);
      index++;
      setTimeout(type, speed);
    } else {
      startBeep(); // start beep only after typing finishes
    }
  }

  // Beep / cursor blinking
  function startBeep() {
    let visible = true;

    setInterval(() => {
      const auxText = "Hi, I'm Caiqui Viera";
      const auxElement = document.getElementById("title-link");

      const selectedMenuItem = document.getElementsByClassName("menu-item");
      const menuItemText = selectedMenuItem[0]
        ? selectedMenuItem[0].textContent.trim()
        : "";

      if (auxElement.textContent == "") {
        auxElement.textContent = auxText;
      }
      auxElement.textContent = visible ? text + "|" : text + " ";
      selectedMenuItem[0].textContent = visible
        ? menuItemText + "|"
        : menuItemText.slice(0, -1);
      visible = !visible;
    }, 500); // cursor blink cada 0.5s
  }

  type();
</script>
<style>
  .gradient-overlay {
    .fade-container::after {
      content: "";
      position: absolute;
      bottom: 0;
      left: 0;
      width: 100%;
      height: 50px; /* Adjust height as needed */
      background: linear-gradient(
        to top,
        rgba(255, 255, 255, 0.5),
        rgba(255, 255, 255, 0)
      ); /* Fades from white to transparent */
      pointer-events: none; /* Allows interaction with content beneath */
    }
  }
</style>
